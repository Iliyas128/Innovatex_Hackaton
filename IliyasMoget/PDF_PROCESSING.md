# üìÑ –û–±—Ä–∞–±–æ—Ç–∫–∞ PDF –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ü—Ä–æ—Å—Ç–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
python batch_process.py testData
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –ù–∞—Ö–æ–¥–∏—Ç –≤—Å–µ PDF –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –ø–∞–ø–∫–µ `testData`
- –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç PDF –≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- –ó–∞–ø—É—Å–∫–∞–µ—Ç –¥–µ—Ç–µ–∫—Ü–∏—é –Ω–∞ –∫–∞–∂–¥–æ–º —Ñ–∞–π–ª–µ
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –≤ `output/`
- –°–æ–∑–¥–∞–µ—Ç JSON —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏

---

### –í–∞—Ä–∏–∞–Ω—Ç 2: –¢–æ–ª—å–∫–æ PDF

```bash
python process_pdfs.py testData
```

–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ PDF —Ñ–∞–π–ª—ã.

---

## üìä –ß—Ç–æ –ø–æ–ª—É—á–∏—Ç–µ

### 1. –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏

–í –ø–∞–ø–∫–µ `output/`:
- `batch_–∏–º—è_—Ñ–∞–π–ª–∞_page_1.jpg` - –ø–µ—Ä–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å bbox
- `batch_–∏–º—è_—Ñ–∞–π–ª–∞_page_2.jpg` - –≤—Ç–æ—Ä–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å bbox
- –∏ —Ç.–¥.

### 2. JSON —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏

–§–∞–π–ª `output/batch_results.json`:

```json
{
  "stats": {
    "signature": 45,
    "stamp": 32,
    "qr": 12,
    "total_files": 89,
    "total_detections": 89
  },
  "results": [
    {
      "image": "temp_images/–¥–æ–∫—É–º–µ–Ω—Ç_page_1.jpg",
      "source_pdf": "testData/–¥–æ–∫—É–º–µ–Ω—Ç.pdf",
      "size": {"width": 3368, "height": 2380},
      "detections": [
        {
          "class": "signature",
          "confidence": 0.876,
          "bbox": {"x": 150, "y": 200, "width": 300, "height": 80}
        }
      ]
    }
  ]
}
```

---

## üí° –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤ –ø–∞–ø–∫–µ

```bash
python batch_process.py testData
```

### –° —É–∫–∞–∑–∞–Ω–∏–µ–º –º–æ–¥–µ–ª–∏

```bash
python batch_process.py testData models/custom_detector.pt
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –ø–∞–ø–æ–∫

```bash
# Windows
for /r testData %f in (*.pdf) do python process_pdfs.py "%~dpf"

# Linux/Mac
find testData -name "*.pdf" -exec python process_pdfs.py {} \;
```

---

## üîß –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã

### –í—Ö–æ–¥–Ω—ã–µ:
- ‚úÖ PDF (–ª—é–±—ã–µ, –≤–∫–ª—é—á–∞—è –∫–∏—Ä–∏–ª–ª–∏—Ü—É –≤ –∏–º–µ–Ω–∞—Ö)
- ‚úÖ JPG, JPEG
- ‚úÖ PNG

### –í—ã—Ö–æ–¥–Ω—ã–µ:
- ‚úÖ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å bbox (JPG)
- ‚úÖ JSON —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏

---

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –°–∫–æ—Ä–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏:

| –¢–∏–ø | CPU | GPU |
|-----|-----|-----|
| PDF (1 —Å—Ç—Ä–∞–Ω–∏—Ü–∞) | ~2.5s | ~0.8s |
| PDF (10 —Å—Ç—Ä–∞–Ω–∏—Ü) | ~25s | ~8s |
| –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ | ~1.5s | ~0.5s |

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

1. **–î–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ GPU
2. **–î–ª—è –±—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏** - –æ–±—Ä–∞–±–æ—Ç–∞–π—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ–∞–π–ª–æ–≤
3. **–î–ª—è –∞—Ä—Ö–∏–≤–æ–≤** - –∑–∞–ø—É—Å–∫–∞–π—Ç–µ –Ω–∞ –Ω–æ—á—å

---

## üéØ Workflow –¥–ª—è —Ö–∞–∫–∞—Ç–æ–Ω–∞

### –®–∞–≥ 1: –ü–æ–ª–æ–∂–∏—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

```
testData/
‚îú‚îÄ‚îÄ –¥–æ–≥–æ–≤–æ—Ä1.pdf
‚îú‚îÄ‚îÄ –¥–æ–≥–æ–≤–æ—Ä2.pdf
‚îú‚îÄ‚îÄ –∞–∫—Ç.pdf
‚îî‚îÄ‚îÄ –ø–∏—Å—å–º–æ.pdf
```

### –®–∞–≥ 2: –ó–∞–ø—É—Å—Ç–∏—Ç–µ –æ–±—Ä–∞–±–æ—Ç–∫—É

```bash
python batch_process.py testData
```

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

```bash
# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
start output\batch_–¥–æ–≥–æ–≤–æ—Ä1_page_1.jpg

# JSON —Å –¥–∞–Ω–Ω—ã–º–∏
notepad output\batch_results.json
```

### –®–∞–≥ 4: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ

```python
import json

# –ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
with open('output/batch_results.json', 'r', encoding='utf-8') as f:
    data = json.load(f)

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
print(f"–í—Å–µ–≥–æ –ø–æ–¥–ø–∏—Å–µ–π: {data['stats']['signature']}")
print(f"–í—Å–µ–≥–æ –ø–µ—á–∞—Ç–µ–π: {data['stats']['stamp']}")

# –î–µ—Ç–∞–ª–∏ –ø–æ –∫–∞–∂–¥–æ–º—É —Ñ–∞–π–ª—É
for result in data['results']:
    print(f"\n–§–∞–π–ª: {result['image']}")
    print(f"–ù–∞–π–¥–µ–Ω–æ: {len(result['detections'])} –æ–±—ä–µ–∫—Ç–æ–≤")
```

---

## üö® Troubleshooting

### PDF –Ω–µ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∫—É PyMuPDF
pip install PyMuPDF

# –ò–ª–∏ –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ
pip install --upgrade PyMuPDF
```

### –ö–∏—Ä–∏–ª–ª–∏—Ü–∞ –≤ –∏–º–µ–Ω–∞—Ö

‚úÖ **–ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è!**

–û–±–∞ —Å–∫—Ä–∏–ø—Ç–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞–±–æ—Ç–∞—é—Ç —Å:
- –†—É—Å—Å–∫–∏–º–∏ –∏–º–µ–Ω–∞–º–∏ —Ñ–∞–π–ª–æ–≤
- –†—É—Å—Å–∫–∏–º–∏ –ø—É—Ç—è–º–∏
- –õ—é–±—ã–º–∏ Unicode —Å–∏–º–≤–æ–ª–∞–º–∏

### –ú–µ–¥–ª–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ GPU –≤–µ—Ä—Å–∏—é PyTorch
pip install torch torchvision --index-url https://download.pytorch.org/whl/cu118
```

### –ú–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

–ü–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–∫—Ä–∏–ø—Ç —Å–ø—Ä–æ—Å–∏—Ç:
```
–£–¥–∞–ª–∏—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è? (y/n):
```

–í–≤–µ–¥–∏—Ç–µ `y` —á—Ç–æ–±—ã —É–¥–∞–ª–∏—Ç—å `temp_images/`

---

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤

| –§—É–Ω–∫—Ü–∏—è | process_pdfs.py | batch_process.py |
|---------|-----------------|------------------|
| PDF | ‚úÖ | ‚úÖ |
| –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è | ‚ùå | ‚úÖ |
| JSON —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã | ‚ùå | ‚úÖ |
| –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ | –ë–∞–∑–æ–≤–∞—è | –ü–æ–¥—Ä–æ–±–Ω–∞—è |
| –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è | ‚úÖ | ‚úÖ |
| –°–∫–æ—Ä–æ—Å—Ç—å | –°—Ä–µ–¥–Ω—è—è | –ë—ã—Å—Ç—Ä–∞—è |

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `batch_process.py` –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –∑–∞–¥–∞—á.

---

## üí° –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ —Å–≤–æ–π –∫–æ–¥

```python
from batch_process import detect_on_image
import torch

# –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏
model = torch.hub.load('ultralytics/yolov5', 'custom', 
                       path='models/custom_detector.pt')

# –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
result = detect_on_image('document.jpg', model)

print(f"–ù–∞–π–¥–µ–Ω–æ: {len(result['detections'])} –æ–±—ä–µ–∫—Ç–æ–≤")
for det in result['detections']:
    print(f"  {det['class']}: {det['confidence']:.2f}")
```

---

## ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!

```bash
# –ü–æ–ª–æ–∂–∏—Ç–µ PDF –≤ testData/
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ:
python batch_process.py testData

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:
# - output/batch_*.jpg (–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏)
# - output/batch_results.json (–¥–∞–Ω–Ω—ã–µ)
```

**–£–¥–∞—á–∏! üöÄ**

